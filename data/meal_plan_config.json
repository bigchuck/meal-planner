{
  "version": "1.0",
  "description": "Nutritional thresholds and risk scoring parameters for meal plan analysis",
  
  "daily_targets": {
    "description": "Per-day thresholds for report risk summary (divided by meal_count for per-meal thresholds)",
    "sugar_g": 50,
    "glycemic_load": 100,
    "protein_g": 100,
    "fat_pct": 35,
    "carbs_pct": 60,
    "calories_min": 1200,
    "calories_max": 3000
  },
  
  "glucose_scoring": {
    "description": "Thresholds for glucose risk calculations",
    
    "carb_risk_ranges": [
      {"max": 5, "score": 0.0, "label": "negligible"},
      {"max": 20, "score": 2.0, "label": "low"},
      {"max": 40, "score": 5.0, "label": "moderate"},
      {"max": 70, "score": 8.0, "label": "high"},
      {"max": null, "score": 10.0, "label": "very_high"}
    ],
    
    "gi_speed_factors": [
      {"max": 40, "factor": 0.8, "label": "slow"},
      {"max": 60, "factor": 1.0, "label": "medium"},
      {"max": null, "factor": 1.2, "label": "fast"}
    ],
    
    "fat_delay_ranges": [
      {"max": 5, "score": 0.0},
      {"max": 15, "score": 1.0},
      {"max": 25, "score": 3.0},
      {"max": 35, "score": 5.0},
      {"max": null, "score": 7.0}
    ],
    
    "protein_tail_ranges": [
      {"max": 10, "score": 0.0},
      {"max": 20, "score": 1.0},
      {"max": 35, "score": 2.0},
      {"max": null, "score": 4.0}
    ],
    
    "fiber_buffer_ranges": [
      {"max": 2, "score": 0.0},
      {"max": 6, "score": 2.0},
      {"max": 10, "score": 4.0},
      {"max": null, "score": 5.0}
    ],
    
    "risk_score_weights": {
      "description": "Weights applied to component scores in final risk calculation",
      "fat_delay": 0.6,
      "protein_tail": 0.5,
      "fiber_buffer": 0.7
    },
    
    "risk_rating_thresholds": [
      {"max": 3, "rating": "low"},
      {"max": 6, "rating": "medium"},
      {"max": 8.5, "rating": "high"},
      {"max": null, "rating": "very_high"}
    ]
  },
  
  "curve_classification": {
    "description": "Rules for classifying expected glucose curve shapes based on meal composition",
    
    "very_low_carb_max": 10,
    
    "delayed_spike": {
      "description": "High fat delays carb absorption (pizza effect)",
      "min_carbs": 25,
      "min_fat": 25,
      "label": "Delayed Spike (Fat-Driven)",
      "curve_description": "High fat content delays carb absorption. Expect delayed, sustained rise peaking 2-3 hours post-meal (pizza effect)."
    },
    
    "double_hump": {
      "description": "Moderate fat + protein causes two-phase response",
      "min_carbs": 30,
      "min_fat": 20,
      "max_fat": 50,
      "min_protein": 20,
      "label": "Double Hump Pattern",
      "curve_description": "Mixed macros create two-phase response: initial carb spike followed by delayed protein-driven rise."
    },
    
    "blunted_spike": {
      "description": "High fiber slows absorption",
      "min_carbs": 15,
      "min_fiber": 8,
      "max_fat": 20,
      "label": "Blunted / Smoothed Spike",
      "curve_description_template": "Carbs present ({carbs}g) but high fiber ({fiber}g) slows absorption. Expect slower, lower peak with smooth rise and fall."
    },
    
    "spike_then_dip": {
      "description": "Fast carbs with low fiber/fat risk reactive hypoglycemia",
      "min_carbs": 25,
      "min_gi": 60,
      "max_fat": 10,
      "max_fiber": 4,
      "label": "Spike Then Possible Dip",
      "curve_description": "Fast, low-fiber carbs with little fat. Strong early spike with higher risk of subsequent dip (reactive hypoglycemia pattern)."
    },
    
    "default": {
      "label": "Moderate Single Spike",
      "curve_description_template": "Moderate rise with single main peak. Overall impact follows carb load ({carbs}g) and risk score ({risk_score}/10)."
    }
  },

  "explain_messages": {
    "carb_risk_messages": [
      {"max": 5, "message": "Negligible carb load - minimal impact"},
      {"max": 20, "message": "Low carb load - small impact"},
      {"max": 40, "message": "Moderate carb load - noticeable impact"},
      {"max": 70, "message": "High carb load - significant impact"},
      {"max": null, "message": "Very high carb load - major impact"}
    ],
    "gi_factor_messages": [
      {"max": 40, "message": "Low GI means slow absorption (reduces risk by 20%)"},
      {"max": 60, "message": "Medium GI means moderate absorption (neutral)"},
      {"max": null, "message": "High GI means fast absorption (increases risk by 20%)"}
    ],
    "fat_delay_messages": [
      {"max": 5, "message": "Minimal fat - no delay effect"},
      {"max": 15, "message": "Low fat - slight delay in absorption"},
      {"max": 25, "message": "Moderate fat - noticeable delay (watch for late spike)"},
      {"max": 35, "message": "High fat - significant delay (pizza effect likely)"},
      {"max": null, "message": "Very high fat - major delay and potential insulin resistance"}
    ],
    "protein_tail_messages": [
      {"max": 10, "message": "Low protein - minimal tail effect"},
      {"max": 20, "message": "Moderate protein - slight extended curve"},
      {"max": 35, "message": "Good protein - noticeable tail (second rise possible)"},
      {"max": null, "message": "High protein - significant tail effect (watch 3-4 hours later)"}
    ],
    "fiber_buffer_messages": [
      {"max": 2, "message": "Minimal fiber - little spike protection"},
      {"max": 6, "message": "Some fiber - moderate spike blunting"},
      {"max": 10, "message": "Good fiber - significant spike reduction"},
      {"max": null, "message": "Excellent fiber - strong spike protection"}
    ],
    "risk_score_interpretation": [
      {"max": 3, "message": "Minimal glucose impact expected"},
      {"max": 6, "message": "Moderate spike likely"},
      {"max": 8.5, "message": "Significant spike expected"},
      {"max": null, "message": "Large spike very likely"}
    ]
  },
  "meal_templates": {
    "breakfast": {
      "protein_low_carb": {
        "display_name": "Breakfast (Protein-First, Low-Carb)",
        "targets": {
          "protein": {"min": 25, "max": 35, "unit": "g"},
          "carbs": {"max": 25, "unit": "g"},
          "fat": {"min": 15, "max": 20, "unit": "g"},
          "gl": {"max": 12, "unit": ""}
        },
        "guidelines": [
          "Eggs (2) or egg + lean meat",
          "Spinach / greens / onion / tomato",
          "Optional dairy (cheese or yogurt, not both)",
          "Coffee / almond milk"
        ],
        "examples": [
          "Eggs + spinach + turkey",
          "Greek yogurt (nonfat) + flax",
          "Almond-flour pancake (no starch stacking)"
        ],
        "rationale": [
          "Blunts morning glucose",
          "Reduces hunger carryover into lunch"
        ]
      }
    },
    "morning snack": {

    },
    "lunch": {
      "primary_carb_window": {
        "display_name": "Lunch (Primary Carb Window)",
        "targets": {
          "protein": { "min": 30, "max": 45, "unit": "g" },
          "carbs": { "min": 30, "max": 45, "unit": "g" },
          "fat": { "min": 20, "max": 25, "unit": "g" },
          "gl": { "max": 20, "unit": "" }
        },
        "guidelines": [
          "One starch maximum (soup counts as starch)",
          "Lean protein anchor",
          "Vegetables included",
          "Avoid stacking bread + potato"
        ],
        "examples": [
          "Beef or turkey bean soup (2C)",
          "Potato (1/2â€“3/4C) + chicken + salad",
          "Beans + meat + vegetables"
        ],
        "rationale": [
          "Best insulin sensitivity window",
          "Allows controlled starch intake",
          "Supports afternoon energy without glucose spikes"
        ]
      }
    },

    "afternoon snack": {
      "stability_bridge": {
        "display_name": "Afternoon Snack (Stability Bridge)",
        "targets": {
          "protein": { "min": 15, "max": 25, "unit": "g" },
          "carbs": { "max": 15, "unit": "g" },
          "fat": { "max": 10, "unit": "g" },
          "gl": { "max": 5, "unit": "" }
        },
        "guidelines": [
          "Protein-first snack",
          "Minimal starch",
          "Fiber preferred",
          "Avoid refined carbs"
        ],
        "examples": [
          "Cottage cheese + berries",
          "Greek yogurt + flax",
          "Jerky + vegetables"
        ],
        "rationale": [
          "Prevents dinner overeating",
          "Maintains glucose stability",
          "Protects protein intake"
        ]
      }
    },

    "dinner": {
      "low_gl_satiating": {
        "display_name": "Dinner (Low-GL, Satiating)",
        "targets": {
          "protein": { "min": 35, "max": 50, "unit": "g" },
          "carbs": { "min": 20, "max": 35, "unit": "g" },
          "fat": { "min": 20, "max": 25, "unit": "g" },
          "gl": { "max": 15, "unit": "" }
        },
        "guidelines": [
          "Whole protein anchor (fish or meat)",
          "Large vegetable volume",
          "Beans or root vegetables in moderation",
          "Avoid fries, noodles, and bread stacking"
        ],
        "examples": [
          "Salmon + asparagus + beans",
          "Halibut + green beans + salad",
          "Ground meat + mixed vegetables"
        ],
        "rationale": [
          "Limits evening glucose exposure",
          "Promotes satiety and recovery",
          "Supports overnight metabolic stability"
        ]
      }
    },

    "evening snack": {
      "protein_dominant": {
        "targets": {
          "protein": { "min": 18, "max": 30, "unit": "g" },
          "carbs": { "max": 15, "unit": "g" },
          "fat": { "max": 8, "unit": "g" },
          "gl": { "max": 5, "unit": "" }
        },
        "guidelines": [
          "Protein-dominant snack required",
          "Very low starch and refined carbs",
          "Fiber preferred when carbs are present",
          "Avoid crunchy or carb-forward snacks",
          "Keep portions small and controlled"
        ],
        "allowed_patterns": [
          "Protein + fiber (e.g., yogurt + flax)",
          "Protein + vegetables (e.g., jerky + celery)",
          "Protein + small berries (<=1/2C)",
          "Protein + minimal fat"
        ],
        "discouraged_patterns": [
          "Carb-forward snacks",
          "Crunch-driven refined carbs (e.g., popcorn)",
          "Dried fruit as a primary component",
          "Starch combined with added fat",
          "Late-night grazing or multiple snacks"
        ],
        "examples": [
          "Greek yogurt (nonfat) + flaxseed",
          "Greek yogurt + flax + whey isolate",
          "Cottage cheese + berries",
          "Jerky + vegetables"
        ],
        "rationale": [
          "Minimizes overnight glucose exposure",
          "Supports muscle protein synthesis during fasting window",
          "Improves satiety without excess calories",
          "Reduces late-evening carb cravings",
          "Promotes stable morning glucose levels"
        ]
      }
    }
  },

  "recommendation_weights": {
    "description": "Global weights for each scorer in final score calculation",
    "nutrient_gap": 1.0,
    "preference": 0.8,
    "portion_efficiency": 0.6,
    "variety": 0.5,
    "staple_food": 0.4,
    "cost_practicality": 0.3
  },

  "scorers": {
    "description": "Configuration parameters for individual scorers",
    
    "nutrient_gap": {
      "description": "Scores meals based on how well they meet nutritional targets",
      "gap_penalty_weights": {
        "1": 3.0,
        "2": 2.0,
        "3": 1.0
      },
      "excess_penalty_weight": 0.5,
      "perfect_match_bonus": 0.1,
      "tolerance_pct": 0.10
    },
    
    "preference": {
      "description": "Scores based on frozen portions and availability flags",
      "frozen_item_bonus": 0.05,
      "staple_item_bonus": 0.03,
      "unavailable_item_penalty": 0.5
    },
    
    "portion_efficiency": {
      "description": "Scores alignment with typical serving sizes",
      "ideal_multiplier_range": [0.5, 1.5],
      "extreme_mult_penalty": 0.2
    },
    
    "variety": {
      "description": "Scores meals based on dietary diversity",
      "recent_usage_penalty": 0.15,
      "days_threshold": 3,
      "code_overlap_penalty": 0.1
    },
    
    "staple_food": {
      "description": "Boosts meals with designated staple items",
      "staple_presence_boost": 0.15,
      "base_score": 0.5
    },
    
    "cost_practicality": {
      "description": "Considers shelf life and preparation complexity",
      "quick_prep_boost": 0.1,
      "complexity_penalty": 0.05
    }
  }
 }